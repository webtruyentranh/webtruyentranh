{% extends "base.html" %}
{% block title %}Y√™u c·∫ßu d·ªãch truy·ªán{% endblock %}

{% block content %}
<style>
  /* ===== Dark themed + centered form ===== */
  .form-dark, .form-dark h2, .form-dark label { color:#fff; }

  /* Canh gi·ªØa ti√™u ƒë·ªÅ + form v·ªõi c√πng b·ªÅ r·ªông */
  .form-dark .page-title,
  .form-dark form{
    max-width: 760px;
    margin: 0 auto;
  }

  /* Flash message */
  .form-dark .flash { margin-bottom:10px; padding:10px 12px; border-radius:10px; }
  .form-dark .flash.success { background: rgba(16,185,129,.12); color:#34d399; }
  .form-dark .flash.error   { background: rgba(239,68,68,.12); color:#f87171; }

  /* Inputs */
  .form-dark input,
  .form-dark textarea,
  .form-dark select{
    width:100%;
    padding:10px;
    border-radius:10px;
    border:1px solid #2b2f3a;
    background:#111826;
    color:#fff;
    outline:none;
  }
  .form-dark input::placeholder,
  .form-dark textarea::placeholder{ color:#cbd5e1; opacity:1; }
  .form-dark select option{ color:#e5e7eb; background:#111826; }

  /* Layout l∆∞·ªõi 2 c·ªôt */
  .form-dark .grid{ display:grid; grid-template-columns:1fr 1fr; gap:12px; }
  .form-dark .full{ grid-column:1/-1; }

  /* H√†nh ƒë·ªông */
  .form-dark .actions{ margin-top:12px; text-align:right; }
  .form-dark .btn-submit{
    background:#2563eb; color:#fff; border:none; padding:10px 14px;
    border-radius:10px; font-weight:700; cursor:pointer;
  }

  /* Responsive */
  @media (max-width: 820px){
    .form-dark .grid{ grid-template-columns:1fr; }
    .form-dark .page-title, .form-dark form{ max-width:100%; padding:0 12px; }
  }
</style>

<div class="wrap form-dark">
  <h2 class="page-title" style="font-weight:800; font-size:22px; margin:12px 0 16px;">üì© Y√™u c·∫ßu d·ªãch truy·ªán</h2>

  {# Flash messages #}
  {% set msgs = get_flashed_messages(with_categories=True) %}
  {% if msgs %}
    <div class="page-title">
      {% for cat, m in msgs %}
        <div class="flash {{ 'success' if cat=='success' else 'error' }}">{{ m }}</div>
      {% endfor %}
    </div>
  {% endif %}

  <form method="post">
    <div class="grid">
      <div>
        <label>T√™n c·ªßa b·∫°n *</label>
        <input name="name" value="{{ form.name or '' }}" required placeholder="">
      </div>
      <div>
        <label>Email li√™n h·ªá *</label>
        <input name="email" type="email" value="{{ form.email or '' }}" required placeholder="">
      </div>

      <div>
        <label>Truy·ªán mu·ªën d·ªãch *</label>
        <input name="comic_title" value="{{ form.comic_title or '' }}" required placeholder="">
      </div>
      <div>
        <label>Ch∆∞∆°ng mu·ªën d·ªãch *</label>
        <input name="chapter" value="{{ form.chapter or '' }}" required placeholder="">
      </div>

      <div class="full">
        <label>Ng√¥n ng·ªØ mu·ªën d·ªãch sang *</label>
        <select name="lang_to" required>
          <option value="" disabled {{ 'selected' if not form.lang_to }}>-- Ch·ªçn --</option>
          <option {{ 'selected' if form.lang_to=='Ti·∫øng Vi·ªát' }}>Ti·∫øng Vi·ªát</option>
          <option {{ 'selected' if form.lang_to=='English' }}>English</option>
          <option {{ 'selected' if form.lang_to=='Êó•Êú¨Ë™û' }}>Êó•Êú¨Ë™û (Japanese)</option>
          <option {{ 'selected' if form.lang_to=='ÌïúÍµ≠Ïñ¥' }}>ÌïúÍµ≠Ïñ¥ (Korean)</option>
          <option {{ 'selected' if form.lang_to=='‰∏≠Êñá' }}>‰∏≠Êñá (Chinese)</option>
          <option {{ 'selected' if form.lang_to=='Fran√ßais' }}>Fran√ßais</option>
          <option {{ 'selected' if form.lang_to=='Deutsch' }}>Deutsch</option>
        </select>
      </div>

      <div class="full">
        <label>Ghi ch√∫ (tu·ª≥ ch·ªçn)</label>
        <textarea name="note" rows="3" placeholder="M√¥ t·∫£ th√™m y√™u c·∫ßu (n·∫øu c√≥)">{{ form.note or '' }}</textarea>
      </div>
    </div>

    <div class="actions">
      <button class="btn-submit">G·ª≠i y√™u c·∫ßu</button>
    </div>
  </form>
</div>

{# Sau khi submit th√†nh c√¥ng, c·∫≠p nh·∫≠t badge chu√¥ng n·∫øu c√≥ #}
{% if msgs %}
<script>
  if (typeof refreshUnreadBadge === 'function') {
    refreshUnreadBadge();
  }
</script>
{% endif %}
{% endblock %}
